import{j as e,r as o,u as f,s as l}from"./index-Ey5ILW5Q.js";import{U as j,a as N}from"./useMyContext-0_wN6Asg.js";import"https://cdn.socket.io/4.4.1/socket.io.esm.min.js";import"./MyContext-7Llxrqd9.js";function w({avatar:a,text:r,author:t}){return e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col overflow-hidden",children:[e.jsx("img",{src:`/resources/characters/${a}.png`,className:"h-10 w-10"}),e.jsx("p",{className:"text-xs",children:t})]}),e.jsx("p",{className:"border-2 rounded-lg p-2 sm:text-lg text-xs",children:r})]})}let x=(a=21)=>crypto.getRandomValues(new Uint8Array(a)).reduce((r,t)=>(t&=63,t<36?r+=t.toString(36):t<62?r+=(t-26).toString(36).toUpperCase():t>62?r+="-":r+="_",r),"");function C(){const{userData:a,resetUserData:r}=j(),[t,n]=o.useState(""),d=f(),[c,i]=o.useState([]),[m,u]=o.useState(0);o.useEffect(()=>(l.on("room-size",s=>{u(s)}),()=>{l.off("room-size")}),[m]),o.useEffect(()=>(l.on("chat-broadcast",s=>{i(h=>[...h,{id:x(),text:s.message,avatar:s.userData.character,author:s.userData.userName}])}),()=>{l.off("chat-broadcast")}),[c]);const p=()=>{i(s=>[...s,{id:x(),text:t,avatar:a.character,author:a.userName}]),l.emit("new-chat",{userData:a,message:t}),n("")},g=()=>{l.emit("custom-room",a.roomCode,"leave-room",s=>{console.log(`exited ${s}`)}),l.disconnect(),r(),d("/")};return e.jsx("div",{className:"h-screen bg-black py-4 overflow-hidden",children:e.jsxs("div",{className:"sm:w-2/3 w-11/12 bg-neutral-light dark:bg-gray-800 h-full grid grid-cols-2 grid-rows-12 mx-auto rounded-lg",children:[e.jsx("div",{className:"col-span-2 row-span-1",children:e.jsxs("div",{className:"flex justify-between dark:bg-primary-dark items-center sm:px-10 px-4 py-2 bg-neutral-light-gray rounded-lg",children:[e.jsxs("p",{className:"font-inter text-primary-medium-green sm:text-lg text-xs dark:text-primary-light",children:["Connected to room:",e.jsx("span",{className:" dark:text-primary-light",children:a.roomCode})]}),e.jsxs("p",{className:"text-accent-light font-inter dark:text-white font-semibold sm:text-lg text-xs",children:["Connected:",m]}),e.jsxs("div",{className:"flex flex-col items-center cursor-pointer",onClick:g,children:[e.jsx("img",{src:"/resources/Exit.png",className:"sm:w-auto sm:h-auto h-5 w-5"}),e.jsx("p",{className:"font-joti text-xs",children:"Exit"})]})]})}),e.jsx("div",{className:"col-span-2 row-span-10 w-full h-full sm:px-10 px-2 sm:py-4 py-2 overflow-y-scroll flex flex-col gap-4",children:c.map(s=>e.jsx(w,{text:s.text,avatar:s.avatar,author:s.author},s.id))}),e.jsxs("div",{className:"col-span-2 row-span-1 dark:bg-primary-dark bg-neutral-dark-gray rounded-lg flex items-center justify-between gap-2 px-8",children:[e.jsx("input",{placeholder:"Enter Message",type:"text",className:"w-full p-2 rounded-lg outline-none dark:text-black",value:t,onChange:s=>n(s.target.value)}),e.jsx("button",{className:"bg-primary-medium rounded-full h-10 w-10 flex justify-center items-center",onClick:p,children:e.jsx(N,{className:"text-xl"})})]})]})})}export{C as default};
